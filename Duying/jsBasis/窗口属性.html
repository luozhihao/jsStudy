<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>窗口属性</title>
  <style>
    body {
      /* height: 1000px; */
      margin: 0;
      padding: 0;
      padding: 700px 0 100px;
      text-align: center;
    }

    .demo1 {
      position: absolute;
      top: 100px;
      left: 100px;
      background: tomato;
      width: 300px;
      height: 300px;
    }

    .demo2 {
      position: absolute;
      top: 50px;
      left: 50px;
      background: #fbbe25;
      width: 200px;
      height: 200px;
    }

    .demo3 {
      background: #ffe767;
      margin-top: 50px;
      margin-left: 50px;
      width: 100px;
      height: 100px;
    }

    #demo {
      border: 1px solid tomato;
      height: 300px;
      width: 500px;
      margin: 0 auto 20px;
      padding: 20px;
      overflow: hidden;
      /* transition: all .75s ease-in-out; */
      box-sizing: border-box;
    }
    #demo::before{
      content: "";
      display: inline-block;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #fbbe25;
    }
    #demo::after{
      content: "";
      display: inline-block;
      width: 25px;
      height: 25px;
      border-radius: 50%;
      background: tomato;
    }
  </style>
</head>

<body>
  <div class="demo1">
    <div class="demo2">
      <div class="demo3">
      </div>
    </div>
  </div>
  <div id="demo">
    <h2>自动滚动效果</h2>
    “小说”一词最早出现于《庄子·外物》：「饰小说以干县令，其于大达亦远矣。」庄子所谓的「小说」，是指琐碎的言论，与小说观念相差甚远。直至东汉桓谭《新论》：「小说家合残丛小语，近取譬喻，以作短书，治身理家，有可观之辞。」班固《汉书．艺文志》将「小说家」列为十家之后，其下的定义为：「小说家者流，盖出于稗官，街谈巷语，道听途说[4]者之所造也。」才稍与小说的意义相近。而中国小说最大的特色，便自宋代开始具有文言小说与白话小说两种不同的小说系统。文言小说起源于先秦的街谈巷语，是一种小知小道的纪录。在历经魏晋南北朝及隋唐长期的发展，无论是题材或人物的描写，文言小说都有明显的进步，形成笔记与传奇两种小说类型。而白话小说则起源于唐宋时期说话人的话本，故事的取材来自民间，主要表现了百姓的生活及思想意识。但不管文言小说或白话小说都源远流长，呈现各自不同的艺术特色。
    小说的特点
    价值性
    小说的价值本质是以时间为序列、以某一人物或几个人物为主线的，非常详细地、全面地反映社会生活中各种角色的价值关系(政治关系、经济关系和文化关系)的产生、发展与消亡过程。非常细致地、综合地展示各种价值关系的相互作用。
    容量性
    与其他文学样式相比，小说的容量较大，它可以细致地展现人物性格和人物命运，可以表现错综复杂的矛盾冲突，同时还可以描述人物所处的社会生活环境。优势是可以提供整体的、广阔的社会生活。
    情节性
    小说主要是通过故事情节来展现人物性格、表现中心的。故事来源于生活，但它通过整理、提炼和安排，就比现实生活中发生的真实实例更加集中，更加完整，更具有代表性。
    环境性
    小说的环境描写和人物的塑造与中心思想有极其重要的关系。在环境描写中，社会环境是重点，它揭示了种种复杂的社会关系，如人物的身份、地位、成长的历史背景等等。自然环境包括人物活动的地点、时间、季节、气候、景物以及场景等等，用来表现人物的身份、地位。自然环境描写对表达人物的心情、渲染环境气氛都有不少的作用。
    发展性
    小说是随着时代的发展而发展的：魏晋南北朝，文人的笔记小说，是中国古代小说的雏形；唐代传奇的出现，尤其是三大爱情传奇，标志着古典小说的正式形成；宋元两代，随着商品经济和市井文化的发展，出现了话本小说，为小说的成熟奠定了坚实的基础；明清小说是中国古代小说发展的高峰，当时是没有可超越者，四大名著皆发于此。
    纯粹性
    纯文学中的小说体裁讲究纯粹性。“谎言去尽之谓纯。”(出自墨人钢《就是》创刊题词)便是所谓的“纯”。也就是说，小说在构思及写作的过程中能去尽政治谎言、道德谎言、商业谎言、维护阶级权贵谎言、愚民谎言等谎言，使呈现出来的小说成品具备纯粹的艺术性。小说的纯粹性是阅读者最重要的审美期待之一。随着时代的发展，不光是小说，整个文学的纯粹性逾来逾成为整个世界对文学审美的一个重要核心。
    溯源
    “小说”一词最早见于《庄子·外物》：“夫揭竿累，趣灌渎，守鲵鲋，其于得大鱼难矣；饰小说以干县令，其于大达亦远矣。”“县”乃古“悬”字，高也；“令”，美也，“干”，追求。是说举着细小的钓竿钓绳，奔走于灌溉用的沟渠之间，只能钓到泥鳅之类的小鱼，而想获得大鱼可就难了。靠修饰琐屑的言论以求高名美誉，那和玄妙的大道相比，可就差得远了。春秋战国时，学派林立，百家争鸣，许多学人策士为说服王侯接受其思想学说，往往设譬取喻，征引史事，巧借神话，多用寓言，以便修饰言说以增强文章效果。庄子认为此皆微不足道，故谓之“小说”，即“琐屑之言，非道术所在”“浅识小道”，也就是琐屑浅薄的言论与小道理之意，正是小说之为小说的本来含义。
    衍化
    东汉桓谭在其所著的《新论》中，对小说如是说：“若其小说家，合丛残小语，近取譬论，以作短书，治身理家，有可观之辞。”认为小说仍然是“治身理家”的短书，而不是为政化民的“大道”。

    　　
    东汉班固在《汉书·艺文志》中写到：“小说家者流，盖出于稗官。街谈巷语，道听涂说者之所造也。孔子曰：‘虽小道，必有可观者焉，致远恐泥，是以君子弗为也。’然亦弗灭也。闾里小知者之所及，亦使缀而不忘。如或一言可采，此亦刍荛狂夫之议也。”这是史家和目录学家对小说所作的具有代表性的解释和评价。班固认为小说是“街谈巷语、道听涂(同“途”)说者之所造也”，虽然认为小说仍然是小知、小道，但从另一角度触及小说讲求虚构，植根于生活的特点。
    奠基
    小说的奠基历经先秦、两汉、魏晋南北朝八百多年的积累和沉淀，
    当历史进入唐代小说才正式形成。追溯八百多年的奠基，主要在四个方面：
    一是寓言故事。如《孟子》、《庄子》、《韩非子》、《战国策》，等书中都有不少人物性格鲜明的寓言故事，它们已经带有小说的意味。
    二是史传。如《左传》、《战国策》、《史记》、《三国志》，描写人物性格，叙述故事情节，或为小说提供了素材，或为小说积累了叙事的经验。
    三是文人笔记。这一点在魏晋南北朝时期尤为明显，文人笔记大都记载一些轶事、掌故、素材。
    四是民间娱乐消闲。各朝代都有茶馆饭店常驻的说话人、说书人，以话本为基础，每天把故事小小的说一段（小说），以吸引客人每天回来听书，希望保证生意兴隆。
  </div>
  <button id="btn">展开</button>
  <script>
    // 获取伪元素的样式表：
    

    var demo = document.getElementById('demo');
    var cssOfBefore = window.getComputedStyle(demo,'before');
    console.log('cssOfBefore：',cssOfBefore);
    var cssOfAfter = window.getComputedStyle(demo,'after')['width'];
    console.log('cssOfAfter-width：',cssOfAfter);

    var btn = document.getElementById('btn');
    var scroll = null; //要用全局变量记忆
    btn.onclick = function () {
      var demoSize = demo.clientHeight;
      console.log(demoSize);
      if (demoSize <= 300) { //用以判断是展开操作还是收起操作，也可设置一个变量判断
        /* 点击展开，按钮变成收起，记录下当前用户观看的位置，然后把内容展开（这里体现是div高度撑大） */
        scroll = getScrollOffset();
        this.innerText = '收起';
        demo.style.height = 1300 + 'px';
        // 添加小说自动滚动效果
        var timer = setInterval(function(){
          window.scrollBy(0,1);
          if(window.pageYOffset >= document.documentElement.offsetHeight - document.documentElement.clientHeight){
            // 滚动条滚动的距离 >= 文档的可滚动总高度 - 可视区域高度，说明滚动到底部了。
            clearInterval(timer);
          }
        },150);
      } else {
        /* 点击收起，按钮变成展开，跳转回去刚才用户观看的位置，然后把内容缩起来 */
        window.scrollTo(scroll.x, scroll.y);
        this.innerText = '展开';
        demo.style.height = 300 + 'px';
      }
    }

    // getElementPosition - 返回元素相对于文档的坐标
    // 原理：利用offsetLeft之类返回的是相对于定位父级的坐标，那累加（通过递归）上定位父级再相对于父级自己的父级的坐标，一直累加到body上，就是相对于文档的坐标了。
    var demo1 = document.getElementsByClassName('demo1')[0];
    var demo2 = document.getElementsByClassName('demo2')[0];
    var demo3 = document.getElementsByClassName('demo3')[0];

    function getElementPosition(ele) {
      var oLeft = ele.offsetLeft,
        oTop = ele.offsetTop,
        fatherOffset = null;
      if (ele.offsetParent) { //判断如果还有定位父级，因为body的定位父级是null，所以条件不会成立。
        fatherOffset = getElementPosition(ele.offsetParent);
        oLeft += fatherOffset.left
        oTop += fatherOffset.top
      }
      return {
        left: oLeft,
        top: oTop
      }
    }
    console.log(getElementPosition(demo3));

    function getScrollOffset() {
      if (window.pageXOffset) {
        return {
          x: window.pageXOffset,
          y: window.pageYOffset
        }
      } else {
        return {
          x: document.body.scrollLeft || document.documentElement.scrollLeft,
          y: document.body.scrollTop || document.documentElement.scrollTop
        }
      }
    }
    console.log(getViewPortOffset());

    function getViewPortOffset() {
      if (window.innerWidth) {
        console.log(1, '现代浏览器支持innerWidth')
        return {
          w: window.innerWidth,
          h: window.innerHeight
        }
      } else {
        if (document.compatMode == 'CSS1Compat') {
          console.log(2, '标准模式')
          // 标准模式
          return {
            w: document.documentElement.clientWidth,
            h: document.documentElement.clientHeight
          }
        } else {
          console.log(3, '向后兼容')
          // 怪异模式 - backCompat - 向后兼容
          return {
            w: document.body.clientWidth,
            h: document.body.clientHeight
          }
        }
      }
    }
    window.onscroll = function () {
      // var top = document.body.scrollTop || document.documentElement.scrollTop;
      var top = window.pageYOffset;
      console.log(top);
    }
  </script>
</body>

</html>